local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local Fold1 = workspace:FindFirstChild("Item_Spawns")
local Fold2 = Fold1 and Fold1:FindFirstChild("Items")

local Plr = Players.LocalPlayer
local Chr = Plr.Character or Plr.CharacterAdded:Wait()
local HRP = Chr:WaitForChild("HumanoidRootPart")

local Plg = Plr:FindFirstChild("PlayerGui")

local function createLabelGui()
    local SCGUI = Instance.new("ScreenGui")
    local TLABEL = Instance.new("TextLabel")
    local UISTR = Instance.new("UIStroke")

    SCGUI.Name = "SCGUI"
    SCGUI.Parent = Plg

    TLABEL.Name = "TLABEL"
    TLABEL.Parent = SCGUI
    TLABEL.Position = UDim2.new(0.019, 0, 0.439, 0)
    TLABEL.Size = UDim2.new(0, 200, 0, 75)
    TLABEL.BackgroundColor3 = Color3.fromRGB(94, 94, 94)
    TLABEL.TextSize = 45
    TLABEL.TextColor3 = Color3.fromRGB(255, 255, 255)
    TLABEL.Text = "ITEMS: 0"

    UISTR.Parent = TLABEL
    UISTR.Thickness = 2
    UISTR.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    UISTR.LineJoinMode = Enum.LineJoinMode.Miter
    UISTR.Color = Color3.fromRGB(0, 0, 0)

    return TLABEL
end

local function createBillboard(name, offset)
    local billboard = Instance.new("BillboardGui")
    billboard.Name = name
    billboard.AlwaysOnTop = true
    billboard.Size = UDim2.new(0, 150, 0, 150)
    billboard.StudsOffset = offset or Vector3.new(0, 0, 0)

    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, 0, 1, 0)
    label.BackgroundTransparency = 1
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.TextScaled = true

    local stroke = Instance.new("UIStroke")
    stroke.Parent = label
    stroke.Thickness = 2
    stroke.Color = Color3.fromRGB(0, 0, 0)

    label.Parent = billboard
    return billboard, label
end

local TLABEL = Plg:FindFirstChild("SCGUI") and Plg.SCGUI:FindFirstChild("TLABEL") or createLabelGui()

RunService.RenderStepped:Connect(function()
    if not Fold2 or not HRP then return end
    local Desc = Fold2:GetChildren()
    for _, item in pairs(Desc) do
        if item:IsA("Model") and item.PrimaryPart then
            local distance = math.floor((HRP.Position - item.PrimaryPart.Position).magnitude)
            local BG1 = item:FindFirstChild("ItemLabel")
            local BG2 = item:FindFirstChild("DistanceLabel")
            if not BG1 then
                BG1, label1 = createBillboard("ItemLabel")
                BG1.Parent = item.PrimaryPart
                BG1.Adornee = item.PrimaryPart
                label1.Text = (item:FindFirstChild("ProximityPrompt") and item.ProximityPrompt.ObjectText or "Unknown")
            end
            if not BG2 or not BG2:IsDescendantOf(item.PrimaryPart) then
                if BG2 then BG2:Destroy() end
                BG2, label2 = createBillboard("DistanceLabel", Vector3.new(0, 2, 0))
                BG2.Parent = item.PrimaryPart
                BG2.Adornee = item.PrimaryPart
                label2.Text = tostring(distance)
            else
                local label2 = BG2:FindFirstChildOfClass("TextLabel")
                if label2 then
                    label2.Text = tostring(distance)
                end
            end
        end
    end
    TLABEL.Text = "ITEMS: "..tostring(#Desc)
end)
